<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Document</title>

  <script>
    (function (w, o, d) {
      w[o] = w[o] || function () {
        w[o][d].push(arguments);
      };
      w[o][d] = w[o][d] || [];
    })(window, 'Osano', 'data');

    function runMarketingScripts() {
      const currentConsent = window.Osano.cm.getConsent();
      if (currentConsent && currentConsent.MARKETING === 'ACCEPT') {
        const scripts = document.querySelectorAll('script[data-osano="MARKETING"][type="text/plain"]');
        scripts.forEach(original => {
          const script = document.createElement('script');
          script.type = 'text/javascript';
          if (original.textContent) {
            script.textContent = original.textContent;
          }
          if (original.src) {
            script.src = original.src;
          }
          original.parentNode.replaceChild(script, original);
        });
      }
    }

    window.Osano('onInitialized', runMarketingScripts);
    window.Osano('onConsentChanged', function() {
        setTimeout(runMarketingScripts, 100);
    });

    window.Osano('onCookieBlocked', function (cookie) {
      console.debug('Osano.js blocked cookie:', cookie);
    });
    window.Osano('userData', 'example user data');
  </script>

  <script src="https://cmp.osano.com/16A0CuTCdGtXx3A1C/ec63760f-40b0-4c2c-b76a-e71dda7f148e/osano.js"></script>
</head>
<body>
  <script type="text/plain" data-osano="MARKETING">
    console.log('Test');
  </script>
</body>
</html>
