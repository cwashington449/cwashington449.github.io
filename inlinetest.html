<!DOCTYPE html>
<html lang="en">
<head>
  <script>
    // Osano Initialization Snippet
    (function (w, o, d) {
      w[o] =
        w[o] ||
        function () {
          w[o][d].push(arguments);
        };
      w[o][d] = w[o][d] || [];
    })(window, 'Osano', 'data');

    // Define the activation logic in a reusable function.
    function activateMarketingScripts() {
      const currentConsent = window.Osano.cm.getConsent();

      // ===================================================================
      // DEBUGGING LINE
      // This will log the entire consent object from Osano to the console.
      console.log('Osano consent object:', currentConsent);
      // ===================================================================

      // The 'if' condition remains the same for now.
      if (currentConsent && currentConsent.MARKETING === 'ACCEPT') {
        document.querySelectorAll('script[data-osano="MARKETING"][type="text/plain"]').forEach(script => {
          script.type = 'text/javascript';
          console.log('Marketing script activated.');
        });
      }
    }

    // Run the check when Osano is initialized.
    window.Osano('onInitialized', activateMarketingScripts);

    // Run the check AGAIN every time consent is changed.
    window.Osano('onConsentChanged', activateMarketingScripts);

    window.Osano('onCookieBlocked', cookie =>
      console.debug('Osano.js blocked cookie:', cookie)
    );

    window.Osano('userData', 'example user data');
  </script>
  
  <script src="https://cmp.osano.com/16A0CuTCdGtXx3A1C/ec63760f-40b0-4c2c-b76a-e71dda7f148e/osano.js"></script> 
  
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <script type="text/plain" data-osano="MARKETING">
    console.log('Test')
  </script>
</body>
</html>
