<script>
  // Osano Initialization Snippet
  (function (w, o, d) {
    w[o] =
      w[o] ||
      function () {
        w[o][d].push(arguments);
      };
    w[o][d] = w[o][d] || [];
  })(window, 'Osano', 'data');

  // CORRECTED LOGIC
  window.Osano('onInitialized', () => {
    console.log('Osano.js initialized');

    // 1. Use the correct function to get the consent object
    const currentConsent = window.Osano.cm.getConsent();

    // 2. Check that the object exists AND has the MARKETING property set to ACCEPT
    if (currentConsent && currentConsent.MARKETING === 'ACCEPT') {
      document.querySelectorAll('script[data-osano="MARKETING"]').forEach(script => {
        if (script.type === 'text/plain') {
          script.type = 'text/javascript';
        }
      });
    }
  });

  window.Osano('onCookieBlocked', cookie =>
    console.debug('Osano.js blocked cookie:', cookie)
  );
</script>
